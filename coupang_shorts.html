<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>훈픽스 (HoonPick's) | 꿀템 스트리밍</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
  <style>
    :root {
      --bg: #0b0c10;
      --card: #111318;
      --muted: #8b90a0;
      --text: #e9e9ef;
      --brand: #7c5cff;
      --header-h: 0px; /* header removed */
      --radius: 20px;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
	  --gapY: 12px; /* 섹션 위·아래 여백 */
    }
    html, body { height: 100%; overscroll-behavior: none;}
    body {
      margin: 0;
      font-family: 'Pretendard', system-ui, -apple-system, Segoe UI, Roboto, Noto Sans KR, sans-serif;
      background: radial-gradient(1200px 600px at 70% -10%, #171a22 0%, #0b0c10 60%) fixed;
      color: var(--text);
      overflow: hidden; /* 상단 고정 + 피드 스냅 스크롤 전용 */
    }

    /* 상단 고정 헤더 (쿠팡 검색 iframe 영역) */
    .header {
      position: fixed; inset: 0 0 auto 0;
      min-height: 56px;
      backdrop-filter: saturate(160%) blur(12px);
      -webkit-backdrop-filter: saturate(160%) blur(12px);
      background: linear-gradient(180deg, rgba(11,12,16,.95), rgba(11,12,16,.75));
      border-bottom: 1px solid rgba(255,255,255,.06);
      z-index: 20;
      display: flex; align-items: center; gap: 12px;
      padding: env(safe-area-inset-top) 14px 10px 14px;
    }
    .brand {
      display: flex; align-items: center; gap: 10px; padding: 10px 12px; border-radius: 14px;
      background: rgba(124,92,255,.12); color: #cfc7ff; border: 1px solid rgba(124,92,255,.25);
      box-shadow: var(--shadow);
      font-weight: 700; letter-spacing: .2px; white-space: nowrap; font-size: 14px;
    }
    .search-wrap { flex: 1; min-width: 0; height: 100%; display:flex; align-items:center; }
    .search-iframe {
      width: 100%; height: 100%; max-height: 56px; border: 0; border-radius: 12px; overflow: hidden; background: #0f1115;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.06);
    }

    /* (옵션) 쿠팡 검색 대체 인풋 */
    .fallback-search { display:none; width:100%; }
    .fallback-search form { display:flex; gap:8px; width:100%; }
    .input { flex:1; min-width:0; padding:12px 14px; border-radius: 12px; border: 1px solid rgba(255,255,255,.1); background:#0f1115; color:var(--text); }
    .btn {
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
      padding: 12px 16px; border-radius: 999px; border: 1px solid rgba(255,255,255,.12);
      background: linear-gradient(135deg, #5a9cff, #3a7bd5);
      color:#efeaff; text-decoration:none; font-weight:700; letter-spacing:.2px; cursor:pointer;
      box-shadow: var(--shadow);
    }

    /* 전체 피드 영역 */
    #feed {
      position: fixed; inset: 0 0 0 0; /* fill screen */
      overflow-y: auto;
	  scroll-snap-stop: always;         /* 여러 장을 한 번에 스킵 방지 */
  overscroll-behavior-y: contain;   /* 위/아래 러버밴드로 밖으로 못 나가게 */
      scroll-snap-type: y mandatory;
      -webkit-overflow-scrolling: touch;
	  touch-action: pan-y;              /* 제스처 충돌 완화 */
    }

    .short {
      position: relative;
      /*height: calc(var(--vh, 1vh) * 100);*/ /* full screen per section */
	  height: 100svh;
		min-height: 100svh; /* 일부 기기 보강 */
      scroll-snap-align: start;
      display: grid; place-items: center;
      /*padding: 4px 12px 64px;
  box-sizing: border-box;*/ /* smaller top gap */
	  padding: var(--gapY) 12px env(safe-area-inset-bottom);
    }

	
    .card {
      width: 100%;
      /*height: 100%;*/ /* fill available section height */
	  height: calc(100% - (var(--gapY)*2 + env(safe-area-inset-bottom)));
      background: var(--card);
      border: 1px solid rgba(255,255,255,.06);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
      position: relative;
      display:flex; flex-direction:column;
    }

    .video-wrap { position: relative; flex: 1 1 auto; background: #000; display:grid; place-items:center; }
    .video-wrap iframe { position:absolute; inset:0; width:100%; height:100%; border:0; }
    .video-wrap .skeleton { width: 100%; height: 100%; background: linear-gradient(90deg, #101319, #0f1115, #101319); background-size: 200% 100%; animation: sk 1.2s infinite linear; position:absolute; inset:0; }
    .caption-overlay { position:absolute; top:6px; left:8px; right:8px; z-index:2; display:flex; align-items:center; gap:8px; padding:10px 12px; 
      background: rgb(222 255 175 / 88%); color:#0e0f13; border-radius: 12px; 
      box-shadow: 0 4px 20px rgba(0,0,0,.25), inset 0 -1px 0 rgba(0,0,0,.06); font-weight:600; font-size: 13px; line-height:1.35; }
    .caption-overlay .index { color:#555; font-weight:700; font-size:12px; margin-right:4px; }
    .caption-overlay .text { display:block; overflow:hidden; text-overflow:ellipsis; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient: vertical; max-height: 3.1em; }
    .video-wrap iframe { position:absolute; inset:0; width:100%; height:100%; border:0; }
    .video-wrap .skeleton { width: 100%; height: 100%; background: linear-gradient(90deg, #101319, #0f1115, #101319); background-size: 200% 100%; animation: sk 1.2s infinite linear; }
    @keyframes sk { 0%{background-position: 0% 0} 100%{background-position: 200% 0} } 100%{background-position: 200% 0} }
    .video-wrap iframe { position:absolute; inset:0; width:100%; height:100%; border:0; }

    .meta {
      padding: 12px 14px; display:flex; align-items:center; justify-content:space-between; gap:12px;
      border-top: 1px solid rgba(255,255,255,.06);
      background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.04));
    }
    .caption { font-size: 14px; line-height: 1.35; color:#e8e9f0; }
    .index { color: var(--muted); font-size: 12px; margin-right: 6px; }

    .product-btn { white-space:nowrap; }

    /* 하단 작은 도움말 */
    .hint {
      position: fixed; bottom: 12px; left: 0; right: 0; z-index: 5;
      display: grid; place-items: center; pointer-events: none;
    }
    .hint .pill {
      pointer-events: auto; font-size: 12px; color:#c8cad6; background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.12); padding: 8px 12px; border-radius: 999px;
      box-shadow: var(--shadow);
    }

    @media (min-width: 1024px) {
      .hint { bottom: 18px; }
    }

    /* ===== 모바일 간격/정렬 보정 (정리본) ===== */
@media (max-width: 480px) {
  /* 섹션 여백: 상단 안전영역 + 6px, 좌우 8px, 하단 48px */
 
  .short { padding: calc(env(safe-area-inset-top) + 6px) 8px 48px;
  box-sizing: border-box; }


  /* 카드: 모바일에선 살짝 좁게, 위 여백 좀 더 */
  .card { width: 100%; margin-top: 0; }

  /* 동영상 위 스와이프 가능하도록 (모바일에서만) */
  .video-wrap iframe { pointer-events: none; }

  /* 상단 UI 컴팩트화 */
  .header { padding: calc(env(safe-area-inset-top) + 4px) 10px 8px 10px; }
  .brand { display: none; }
  .search-iframe { height: 44px; max-height: 44px; }
  .fallback-search form .input { padding: 10px 12px; }
  .btn { padding: 10px 14px; }
}

/* ===== 데스크톱/기본값 (모바일 밖) ===== */
/* 기본 카드 폭/여백 — 전역(모바일 밖)에서 한 번만 선언 */
.card { width: 100%; margin-top: 0; }






/* 마지막 숏 뒤에 빈 공간을 만들어 스냅이 더 위로 걸리게 함 */
#feed::after { content:""; display:block; height: 0; }



	  
  </style>
  <!-- YouTube IFrame Player API (공식) -->
  <script src="https://www.youtube.com/iframe_api"></script>

<style id="fill-screen-tweak">
  /* Fill the viewport while preserving all behaviors */
  .short > .card { height: 100%; }
</style>







<style id="fullscreen-fill">
  /* 1) 섹션 내부 여백: 세이프에어리어만 남기고 나머지 제거 (시각적 하단 공백 원천차단) */
  #feed .short {
    padding-top: env(safe-area-inset-top);
    padding-right: 12px;           /* 기존 좌우 패딩 유지 */
    padding-left: 12px;
    padding-bottom: env(safe-area-inset-bottom);
    box-sizing: border-box;        /* 패딩 포함해도 100svh 유지 (이미 넣었다면 중복 무방) */
  }

  /* 2) 카드가 섹션을 100% 채우도록(그리드 center 정렬로 생기는 위·아래 빈 공간 제거) */
  #feed .short > .card {
    height: 100%;
    margin: 0;                     /* 혹시 남아있을 수 있는 여백 제거 (우리가 0으로 맞춘 것 재보강) */
    align-self: stretch;           /* place-items: center 무력화: 세로로 꽉 채움 */
    justify-self: stretch;         /* 가로도 꽉 채움 (좌우 12px 패딩 안에서) */
  }

  /* 3) 미디어가 카드 내부를 가득 채우도록 (종류 상관없이 커버) */
  #feed .short > .card video,
  #feed .short > .card img,
  #feed .short > .card .player,
  #feed .short > .card .media {
    height: 100%;
    width: 100%;
    object-fit: cover;             /* 비율 유지하며 꽉 채움 (상하 검은띠 방지) */
  }
</style>






</head>
<body>
  <!-- HEADER: 쿠팡 검색 iframe 고정 -->
  

  <!-- 피드: 스크롤-스냅으로 쇼츠처럼 한 장씩 -->
  <main id="feed" aria-label="YouTube Shorts feed"></main>
<!-- 
  <div class="hint">
    <div class="pill">위·아래로 스와이프하면 다음 영상으로 이동합니다</div>
  </div>
-->

<script>
  /* ===== 데이터 (사용자 제공) ===== */
  var ytLinks = [
"https://youtube.com/shorts/P5-x3C2G7DY?si=Pp49-AVrYGFvGTP7",
	"https://youtube.com/shorts/5Tvcff5GO5Y?si=KneKbSvLiXlU2Ewm",
	"https://youtube.com/shorts/IyPFNgu2qHk?si=QTqsQh95EhmkMMWr",
	"https://youtube.com/shorts/wZup8BlQtew?si=_1sJQAh3ua2PjT-N",
	"https://youtube.com/shorts/-nMyPLMLBIo?si=umt38VKCHTFhVWcR",
	"https://youtube.com/shorts/tPQpOYvPPDM?si=VTYfgcE656pYdtm3",
	"https://youtube.com/shorts/41mFEFfzTKQ?si=z-9IVBIa1FX7wXaG",
	"https://youtube.com/shorts/4-W3RZ_BVFA?si=_ID3_bxIAaNge225",
	"https://youtube.com/shorts/s9hYBB5uZ5s?si=kOgS-9glXrE8-Hgb",
	"https://youtube.com/shorts/OZiv3ueEKW0?si=abzQbl2g05DkoRJJ",
	"https://youtube.com/shorts/uR0jkItnEDc?si=GeDBQcvgSB0yh2Zw", 
	"https://youtube.com/shorts/CLkn4G32jCY?si=j9vwlwwUcBaLsXp-",
    "https://youtube.com/shorts/AdCYD7tPmaU?si=Gt5L97xcZyZ57Dn0",
    "https://youtube.com/shorts/jw3q06ZoVvk?si=hQtkh3l3Hx6Ly1r_",
    "https://youtube.com/shorts/I7FwJq40LTg?si=cX9rbO01D5gNTaCk",
    "https://youtube.com/shorts/YlSlckClIuE?si=DQeMA0RwmucvND3f",
    "https://youtube.com/shorts/NK3dhvdNLv8?si=VhS_Zyh-mbz7oBBS",
    "https://youtube.com/shorts/iskyNy6EGd4?si=XY3V6ljnIrknMt6k",
    "https://youtube.com/shorts/EQYcFQlqStI?si=9aP1co1fOAJnOz33",
    "https://youtube.com/shorts/BL_sn_UooCY?si=lLrNBdwWoy3Rup5z",
    "https://youtube.com/shorts/ia1silfO0cQ?si=gXdn_1fk3b-tuG4w",
    "https://youtube.com/shorts/cFlqkxtUkPc?si=p5UUfk0ee6e8q2cb",
    "https://youtube.com/shorts/mT97G9kBJjc?si=KNDVSxdNonQt0AHz",
    "https://youtube.com/shorts/cswuUrOpd5M?si=F4IdWVVOgoyldvgs",
    "https://youtube.com/shorts/uGPcjkD35QQ?si=NyPGbd-_8Ai1iYNg",
    "https://youtube.com/shorts/cB0erbdES4s?si=jdeSR27i-8UabyRP",
    "https://youtube.com/shorts/uS9EGnShj0s?si=Vb5JOQwZb3Q-jDPv",
    "https://youtube.com/shorts/8G3FHyKdIdg?si=8oDbu2d1NyVhaBdD",
    "https://youtube.com/shorts/KOzPtqZJJzY?si=jyKq1VLswB6DPsWp",
    "https://youtube.com/shorts/fVInEa-T54w?si=yFArHu0dASFs2MnK",
    "https://youtube.com/shorts/8-1YuPzJLHA?si=YXfw8O9aKX-uvQvC",
    "https://youtube.com/shorts/wN1tRDnO1fE?si=5x61qSlsODXfwGmI",
    "https://youtube.com/shorts/e4JobP8rqH0?si=e8T6Jk2AQK6rRGVc",
    "https://youtube.com/shorts/lL05TQy27Ig?si=NBsyT6doLf6WSaiW"
  ];

  var coupangLinks = [
"https://link.coupang.com/a/cZh1vn",
	"https://link.coupang.com/a/cZhlZ5",
	"https://link.coupang.com/a/cZg8SQ",
	"https://link.coupang.com/a/cZg42z",
	"https://link.coupang.com/a/cYZHQx",
	"https://link.coupang.com/a/cYY887",
	"https://link.coupang.com/a/cYY1Z2",
	"https://link.coupang.com/a/cYYU0R",
	"https://link.coupang.com/a/cYYOgW",
	"https://link.coupang.com/a/cYS8ZW",
	"https://link.coupang.com/a/cYSX2K",
	"https://link.coupang.com/a/cYSRRx",
    "https://link.coupang.com/a/cYAP0B",
    "https://link.coupang.com/a/cYANHc",
    "https://link.coupang.com/a/cYyLfs",
    "https://link.coupang.com/a/cYyHxJ",
    "https://link.coupang.com/a/cYmH59",
    "https://link.coupang.com/a/cXZexN",
    "https://link.coupang.com/a/cYcdJX",
    "https://link.coupang.com/a/cYccGm",
    "https://link.coupang.com/a/cYcaHU",
    "https://link.coupang.com/a/cYb628",
    "https://link.coupang.com/a/cYb5Ux",
    "https://link.coupang.com/a/cYb4n8",
    "https://link.coupang.com/a/cYb1zP",
    "https://link.coupang.com/a/cYbqpN",
    "https://link.coupang.com/a/cYbmOW",
    "https://link.coupang.com/a/cYaTWq",
    "https://link.coupang.com/a/cXZwtK",
    "https://link.coupang.com/a/cXZKtP",
    "https://link.coupang.com/a/cXZFI2",
    "https://link.coupang.com/a/cXZNOd",
    "https://link.coupang.com/a/cX46Ru",
    "https://link.coupang.com/a/cX310L"
  ];

  var productCaptions = [
"추운 겨울 수족냉증 필수템!!!!",
	"먹으면 멈출 수 없다는 에스파 닝닝 쫀득쿠키!",
	"산다라박이 사용하는 겨울 미스트! 대박!",
	"정재형&주우재 추천 반팔티!!",
	"무선 온열 담요! 이번 겨울 필수템!!!!",
	"브리사 욕실 휴대폰 방수 거치대, 하루종일 샤워 가능 ㅎㅎ",
	"곰곰 THE 신선한 한돈 목살 구이용 (냉장), 1kg, 1팩",
	"인테리어 소품, 옷걸이! 집에 오는 사람들마다 어디서 샀냐고 물아봐요✨",
	"감성 인테리어 & 조명 벽장식 소품 화분(배터리 내장 +리모컨)",
	"정리의 신! 4구 비닐봉지 지퍼백 정리 케이스",
	"육아는 템빨ㅎㅎ 낙상방지 아기침대 침대가드!",
	"송혜교가 입은 니트 가디건 스웨터 ✨",
    "요즘 누가 커튼사? 이제는 스마트필름이 대세🌤️",
    "휴대용 미니세탁기(세척기)! 남편들 필수템!",
    "화장 전에 꼭하세요. 더현대 1위 · 올영 품절템",
    "꼬지 말고, 다리 모아! 오늘부터 습관 교정.",
    "이영자표 파김치! 다이어트 ㅃㅇ! 침질질~",
    "애완용품 세이프 지퍼로 깔끔끝 ✨",
    "말차 한 스푼, 장원영 녹차가루 🍵",
    "입술꿀광! 연예인 립밤 💄",
    "가볍게 툭! 수지 패딩로 보온력 업 ⛄",
    "이청아가 홀딱반한 향수! ✨",
    "꾸안꾸 차예련 무드, 가디건 🧶",
    "권나라 화이트닝 이거면 끝! ✨",
    "닐라닐라 바닐라~ 차예련이 추천한 향수! ✨",
    "미끌미끌 노프라블럼 비누거치대 🫧",
    "썰·채·다짐 3초 컷 👩‍🍳",
    "실리콘 채소 과일 보관용기 🥬",
    "샤오미 미쳤음! 샤오미 보조배터리 🔋",
    "먼지순삭 지아이비 핸디형 무선 청소기 🧹",
    "빨래는 미니 빨래 건조대로 뽀송하게 🧺",
    "목욕시간 목욕핸들로 즐겁게 🛁",
    "밑줄 쫙— 하이라이터 밑줄 스티커 펜 ✍️",
    "이번 겨울 필수템! 바람 그만! 🌬️"
  ];

  /* ===== 유틸 ===== */
  function shortsToEmbed(url) {
    var m = url.match(/shorts\/([a-zA-Z0-9_-]+)/);
    var id = m ? m[1] : null;
    if (!id) return null;
    return 'https://www.youtube.com/embed/' + id + '?autoplay=1&mute=1&loop=1&playlist=' + id + '&controls=0&modestbranding=1&rel=0&playsinline=1&enablejsapi=1';
  }

  // 간단한 맵(구형 브라우저 호환)
  var players = {};
  function setPlayer(id, obj){ players[id] = obj; }
  function getPlayer(id){ return players[id]; }
  function delPlayer(id){ try { delete players[id]; } catch(e){} }

  function mountPlayer($card, index){
    var $wrap = $card.find('.video-wrap');
    if ($wrap.data('mounted')) return;
    var embed = shortsToEmbed(ytLinks[index]);
    if (!embed) return;
    var iframeId = 'yt-' + index;
    var iframeHtml = '<iframe class="video" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen id="' + iframeId + '" loading="eager" src="' + embed + '" title="YouTube Shorts ' + (index+1) + '"></iframe>';
    var $iframe = $(iframeHtml);
    $wrap.find('.skeleton').remove();
    $wrap.append($iframe).data('mounted', true);

    if (window.YT && YT.Player) {
      try {
        var p = new YT.Player(iframeId, {
          events: {
            'onReady': function(){ setPlayer(iframeId, { player: p, ready: true }); try { p.playVideo(); } catch(e){} }
          }
        });
        setPlayer(iframeId, { player: p, ready: false });
      } catch(e){}
    }
  }

  function unmountPlayer($card, index){
    var iframeId = 'yt-' + index;
    var rec = getPlayer(iframeId);
    if (rec) { try { rec.player.stopVideo(); rec.player.destroy(); } catch(e){} delPlayer(iframeId); }
    var $wrap = $card.find('.video-wrap');
    $wrap.find('iframe.video').remove();
    if ($wrap.find('.skeleton').length === 0) { $wrap.append('<div class="skeleton"></div>'); }
    $wrap.data('mounted', false);
  }

  function setVH(){
    var vh = window.innerHeight * 0.01;
    document.documentElement.style.setProperty('--vh', vh + 'px');
  }

  /* ===== 초기화 ===== */
  $(function(){
    setVH();
    $(window).on('resize orientationchange', function(){ setVH(); });

    var $feed = $('#feed');
    var len = Math.min(ytLinks.length, coupangLinks.length, productCaptions.length);

    for (var i = 0; i < len; i++) {
      var overlay = '<div class="caption-overlay"><span class="index">#' + (i+1) + '</span><span class="text">' + productCaptions[i] + '</span></div>';
      var itemHtml = '<section class="short" data-index="' + i + '">' +
        '<article class="card">' +
        '<div class="video-wrap">' + overlay + '<div class="skeleton"></div></div>' +
        '<div class="meta">' +
        '<a class="btn product-btn" href="' + coupangLinks[i] + '" target="_blank" rel="noopener sponsored" style="width:100%;">👆 쿠팡 상품 보러가기</a>' +
        '</div>' +
        '</article>' +
        '</section>';
      var $item = $(itemHtml);
      $feed.append($item);
    }

    // 보이는 순간 mount/재생, 벗어나면 unmount
    var io = new IntersectionObserver(function(entries){
      for (var j = 0; j < entries.length; j++) {
        var entry = entries[j];
        var $sec = $(entry.target);
        var $card = $sec.find('.card');
        var idx = parseInt($sec.data('index'), 10);
        if (isNaN(idx)) { continue; }
        if (entry.isIntersecting && entry.intersectionRatio > 0.8) {
          mountPlayer($card, idx);
        } else {
          unmountPlayer($card, idx);
        }
      }
    }, { root: document.querySelector('#feed'), threshold: [0, 0.8, 1] });

    var secs = document.querySelectorAll('.short');
    for (var k = 0; k < secs.length; k++) { io.observe(secs[k]); }

    document.getElementById('feed').addEventListener('scroll', function(){}, { passive: true });
  });



/* === 스와이프/휠: 한 번에 1장, 감도 조절, 연속 이벤트 컷 === */
(function enablePagingSwipe(){
  var feed = document.getElementById('feed');
  var sections = Array.prototype.slice.call(document.querySelectorAll('.short'));
  if (!feed || !sections.length) return;

  var index = 0, lock = false;

  // [NEW] 같은 방향으로 빠르게 연속 입력되는 걸 한 번만 허용 (디바운스/스로틀)
  var lastNavAt = 0;
  var lastDir = 0;
  var NAV_COOLDOWN = 480;   // 밀리초. 더 둔감하게 하려면 520~600으로

  // 현재 보이는 섹션 동기화 (0.8 이상 보일 때만)
  var io2 = new IntersectionObserver(function(entries){
    entries.forEach(function(e){
      if (e.isIntersecting && e.intersectionRatio > 0.8) {
        var i = sections.indexOf(e.target);
        if (i >= 0) index = i;
      }
    });
  }, { root: feed, threshold: [0.8] });
  sections.forEach(function(s){ io2.observe(s); });

  function scrollToIndex(i){
    var clamped = Math.max(0, Math.min(sections.length - 1, i));
    lock = true;
    sections[clamped].scrollIntoView({ block: 'start', behavior: 'smooth' });
    // [TUNING] 스무스 스크롤 시간 여유
    setTimeout(function(){ lock = false; }, 420);
  }

  // ── 터치(모바일)
  var startY = 0, lastY = 0, moved = false;
  feed.addEventListener('touchstart', function(e){
    if (e.touches.length !== 1) return;
    startY = lastY = e.touches[0].clientY;
    moved = false;
  }, { passive: true });

  feed.addEventListener('touchmove', function(e){
    if (lock || e.touches.length !== 1) return;
    lastY = e.touches[0].clientY;
    moved = true;
  }, { passive: true });

  feed.addEventListener('touchend', function(){
    if (lock || !moved) return;
    var dy = lastY - startY;              // + 아래(이전), - 위(다음)
    var THRESHOLD = 84;                   // 감도 노브: 60~96 권장. 수치↑ = 둔감
    if (Math.abs(dy) <= THRESHOLD) {
      // 임계치 미만이면 현재 카드로 되돌림
      scrollToIndex(index);
      return;
    }

    // [NEW] 같은 방향 연속 제스처 컷
    var dir = (dy < 0 ? 1 : -1);
    var now = performance.now();
    if (now - lastNavAt < NAV_COOLDOWN && dir === lastDir) return;
    lastNavAt = now; lastDir = dir;

    scrollToIndex(index + dir);
  }, { passive: true });

  // ── 휠/트랙패드(데스크톱)
  feed.addEventListener('wheel', function(e){
    if (lock) return;
    var THRESHOLD_WHEEL = 52;             // 휠 감도 노브: 40~64 권장
    if (Math.abs(e.deltaY) < THRESHOLD_WHEEL) return;

    // [중요] 네이티브 관성으로 2~3장 넘김 방지
    e.preventDefault();

    // [NEW] 같은 방향 연속 휠 컷
    var dir = (e.deltaY > 0 ? 1 : -1);
    var now = performance.now();
    if (now - lastNavAt < NAV_COOLDOWN && dir === lastDir) return;
    lastNavAt = now; lastDir = dir;

    scrollToIndex(index + dir);
  }, { passive: false });
})();





  // IFrame API 준비 콜백 (observer가 mount를 담당)
  window.onYouTubeIframeAPIReady = function(){};
</script>



<script>
  // ── 엣지 가드: 최상단/최하단 러버밴드로 주소창 토글되는 현상 완화
  (function edgeGuard(){
    var feed = document.getElementById('feed');
    if (!feed) return;

    function armOffset(){
      requestAnimationFrame(function(){
        try { if (feed.scrollTop < 0) feed.scrollTop = 0; } catch(e){}
      });
    }
    armOffset();

    feed.addEventListener('scroll', function(){
      var max = feed.scrollHeight - feed.clientHeight;
      if (feed.scrollTop <= 0) feed.scrollTop = 0;            // 최상단 보호
      else if (feed.scrollTop >= max) feed.scrollTop = max; // 최하단 보호
    }, {passive:true});

    window.addEventListener('resize', armOffset);
    window.addEventListener('orientationchange', armOffset);
  })();
</script>
<script>
  // ── iOS 전용: 모멘텀 스크롤 완화로 주소창 토글 빈도 감소
  (function softenIOSMomentum(){
    var ua = navigator.userAgent || '';
    var isiOS = /iP(hone|od|ad)/.test(ua);
    if (!isiOS) return;
    var feed = document.getElementById('feed');
    if (!feed) return;
    feed.style.webkitOverflowScrolling = 'auto'; // 기본 touch → iOS에서만 auto
  })();
</script>




<style id="final-patch-styles">
  html, body { height: 100%; overflow: hidden; }
  /* Feed full-viewport, stabilized area */
  #feed {
    position: fixed; inset: 0;
    height: var(--final-stable, 100vh);
    padding-bottom: var(--final-addr, 0px);
    overflow-y: auto;
    overscroll-behavior: contain;
    -webkit-overflow-scrolling: auto;
    scroll-snap-type: y mandatory;
    scroll-snap-stop: always;
    background: inherit;
  }
  /* Each short fills stabilized area */
  .short {
  box-sizing: border-box;
    height: calc(var(--final-stable, 100vh) - var(--final-addr, 0px));
    min-height: calc(var(--final-stable, 100vh) - var(--final-addr, 0px));
    scroll-snap-align: start;
    scroll-snap-stop: always;
  }
  /* Make sure video can be tapped and fills the card */
  .short video {
    width: 100%;
    height: 100%;
    object-fit: cover;
    pointer-events: auto;
    touch-action: manipulation;
    display: block;
  }
</style>
<script id="final-patch-stablevh">
(function(){
  // Track the MAX viewport height we see (stable), and the current visible height.
  // Use the difference as address bar compensation without resizing content.
  var stable = 0;
  var raf = null;
  function compute(){
    var cur = (window.visualViewport && window.visualViewport.height) ? window.visualViewport.height : window.innerHeight;
    if (cur > stable) stable = cur; // adopt max seen height as the "stable" baseline
    var addr = Math.max(0, stable - cur);
    document.documentElement.style.setProperty('--final-stable', stable + 'px');
    document.documentElement.style.setProperty('--final-addr', addr + 'px');
  }
  function schedule(){ if (raf) cancelAnimationFrame(raf); raf = requestAnimationFrame(compute); }
  schedule();
  window.addEventListener('resize', schedule);
  window.addEventListener('orientationchange', function(){ stable = 0; setTimeout(schedule, 150); });
  if (window.visualViewport) {
    window.visualViewport.addEventListener('resize', schedule);
    window.visualViewport.addEventListener('scroll', schedule);
  }
})();
</script>
<script id="final-patch-paging">
(function enableSingleStepPaging(){
  var feed = document.getElementById('feed');
  var sections = Array.prototype.slice.call(document.querySelectorAll('.short'));
  if (!feed || !sections.length) return;

  var index = 0;
  var inFlight = false;
  var settleTimer = null;

  var THRESHOLD = 84;        // px, swipe distance threshold
  var THRESHOLD_WHEEL = 52;  // wheel/trackpad threshold
  var NAV_COOLDOWN = 420;    // ms, same-direction cooldown
  var lastNavAt = 0;
  var lastDir = 0;

  // Sync current index based on what's mostly visible
  var io = new IntersectionObserver(function(entries){
    entries.forEach(function(e){
      if (e.isIntersecting && e.intersectionRatio > 0.8) {
        var i = sections.indexOf(e.target);
        if (i >= 0) index = i;
      }
    });
  }, { threshold: [0.25, 0.5, 0.8, 1] });
  sections.forEach(function(s){ io.observe(s); });

  function release(){
    inFlight = false;
    if (settleTimer){ clearTimeout(settleTimer); settleTimer = null; }
  }

  function scrollToIndexOnce(i){
    var clamped = Math.max(0, Math.min(sections.length - 1, i));
    if (inFlight) return;
    var now = Date.now();
    var dir = (clamped > index) ? 1 : (clamped < index ? -1 : 0);
    if (dir !== 0 && dir === lastDir && (now - lastNavAt) < NAV_COOLDOWN) return;

    inFlight = true;
    index = clamped;
    lastDir = dir;
    lastNavAt = now;

    sections[clamped].scrollIntoView({ block: 'start', behavior: 'smooth' });

    // Prefer scrollend if available
    function onEnd(){
      try { feed.removeEventListener('scrollend', onEnd); } catch(_) {}
      release();
    }
    try { feed.addEventListener('scrollend', onEnd, { once: true }); } catch(_) {}

    // Fallback: scroll debounce
    function onScroll(){
      if (settleTimer) clearTimeout(settleTimer);
      settleTimer = setTimeout(function(){
        try { feed.removeEventListener('scroll', onScroll); } catch(_) {}
        release();
      }, 240);
    }
    feed.addEventListener('scroll', onScroll, { passive: true });

    // Safety timeout
    settleTimer = setTimeout(function(){
      try { feed.removeEventListener('scroll', onScroll); } catch(_) {}
      release();
    }, 900);
  }

  // Touch swipe (no preventDefault to keep video taps working)
  var startY = 0, lastY = 0, moved = false;
  feed.addEventListener('touchstart', function(e){
    if (!e.touches || e.touches.length !== 1) return;
    startY = lastY = e.touches[0].clientY;
    moved = false;
  }, {passive:true});

  feed.addEventListener('touchmove', function(e){
    if (!e.touches || e.touches.length !== 1) return;
    lastY = e.touches[0].clientY;
    moved = true;
  }, {passive:true});

  feed.addEventListener('touchend', function(){
    if (!moved || inFlight) return;
    var dy = lastY - startY;
    if (Math.abs(dy) < THRESHOLD) return;
    var dir = (dy > 0) ? -1 : 1;
    scrollToIndexOnce(index + dir);
  }, {passive:true});

  // Wheel/trackpad
  feed.addEventListener('wheel', function(e){
    if (inFlight) return;
    var dy = e.deltaY;
    if (Math.abs(dy) < THRESHOLD_WHEEL) return;
    var dir = (dy > 0) ? 1 : -1;
    scrollToIndexOnce(index + dir);
  }, {passive:true});

  // Top/bottom rubber-band guard
  feed.addEventListener('scroll', function(){
    var max = feed.scrollHeight - feed.clientHeight;
    if (feed.scrollTop <= 0) feed.scrollTop = 0;
    else if (feed.scrollTop >= max) feed.scrollTop = max;
  }, {passive:true});
})();
</script>















<style>
  /* 마지막 영상 안내 토스트 */
  #endToast{
    position: fixed;
    left: 50%;
    bottom: calc(env(safe-area-inset-bottom) + 24px);
    transform: translateX(-50%) translateY(16px);
    opacity: 0; pointer-events: none;
    background: rgba(0,0,0,.8); color:#fff;
    padding:10px 14px; border-radius:999px;
    font-size:14px; line-height:1;
    transition: opacity .25s ease, transform .25s ease;
    z-index: 9999;
  }
  #endToast.show{ opacity:1; transform:translateX(-50%) translateY(0); }
  @media (prefers-reduced-motion: reduce){ #endToast{ transition:none; } }
</style>

<script>
(() => {
  const scroller = document.querySelector('#feed');
  if (!scroller) return;

  // 토스트 엘리먼트 (자동 생성)
  let toast = document.getElementById('endToast');
  if (!toast) {
    toast = document.createElement('div');
    toast.id = 'endToast';
    toast.textContent = '마지막 영상입니다. 🥰';
    document.body.appendChild(toast);
  }

  let lastShown = 0;
  const COOLDOWN = 1200; // ms
  const showToast = () => {
    const now = Date.now();
    if (now - lastShown < COOLDOWN) return;
    lastShown = now;
    toast.classList.add('show');
    clearTimeout(showToast._t);
    showToast._t = setTimeout(() => toast.classList.remove('show'), 1200);
  };

  // "마지막 카드가 화면에 충분히 들어왔는지" 상태 추적
  let lastIsActive = false;
  const updateObserver = () => {
    const secs = scroller.querySelectorAll('.short');
    if (!secs.length) return;
    const last = secs[secs.length - 1];

    const io = new IntersectionObserver((ents) => {
      for (const e of ents) {
        if (e.target === last) lastIsActive = e.isIntersecting && e.intersectionRatio > 0.8;
      }
    }, { root: scroller, threshold: [0, 0.8, 1] });

    io.observe(last);
  };

  // 초기 + 동적 추가 대비
  if (scroller.children.length) updateObserver();
  const mo = new MutationObserver(() => updateObserver());
  mo.observe(scroller, { childList: true });

  // 스크롤 방향이 "아래로"이고, 이미 거의 끝에 도달했을 때 토스트
  let prevTop = 0;
  scroller.addEventListener('scroll', () => {
    const el = scroller;
    const maxTop = el.scrollHeight - el.clientHeight;
    const curTop = el.scrollTop;
    const goingDown = curTop > prevTop + 1; // 약간의 데드존
    prevTop = curTop;

    // 끝에서 1px 이내 + 마지막 카드가 활성화된 상태 + 아래로 더 내리는 중
    if (goingDown && curTop >= maxTop - 1 && lastIsActive) {
      showToast();
    }
  }, { passive: true });

  // 데스크톱 휠/키보드(아래로)도 대응
  scroller.addEventListener('wheel', (e) => {
    if (e.deltaY > 0 && lastIsActive) {
      const el = scroller;
      if (Math.ceil(el.scrollTop + el.clientHeight) >= el.scrollHeight - 1) showToast();
    }
  }, { passive: true });

  document.addEventListener('keydown', (e) => {
    if (!lastIsActive) return;
    const keys = ['ArrowDown','PageDown',' ']; // 스페이스는 아래로 스크롤
    if (keys.includes(e.key)) {
      const el = scroller;
      if (Math.ceil(el.scrollTop + el.clientHeight) >= el.scrollHeight - 1) showToast();
    }
  }, { passive: true });
})();
</script>












	
</body>
</html>
